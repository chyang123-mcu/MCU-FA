<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è²¡å ±åˆ†ææ™ºæ…§çœ‹æ¿ | Bauhaus Edition</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&family=Montserrat:wght@800&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #e0e5ec;
            --nm-light: #ffffff;
            --nm-shadow: #a3b1c6;
            --bauhaus-red: #d9432f;
            --bauhaus-blue: #2d5a9e;
            --bauhaus-yellow: #f2c14e;
            --text-main: #3d4b5f;
            --transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Neumorphism è¦–è¦ºè¨­è¨ˆ */
        .nm-flat {
            background: var(--bg);
            box-shadow: 8px 8px 15px var(--nm-shadow), -8px -8px 15px var(--nm-light);
            border-radius: 20px;
            border: none;
        }
        .nm-inset {
            background: var(--bg);
            box-shadow: inset 6px 6px 12px var(--nm-shadow), inset -6px -6px 12px var(--nm-light);
            border-radius: 15px;
            border: none;
        }
        .btn-active {
            box-shadow: inset 4px 4px 8px var(--nm-shadow), inset -4px -4px 8px var(--nm-light);
            color: var(--bauhaus-blue);
        }

        /* Sidebar å°èˆª */
        #sidebar {
            width: 280px;
            height: 100vh;
            padding: 40px 25px;
            position: fixed;
            display: flex;
            flex-direction: column;
            z-index: 1000;
            transition: var(--transition);
        }
        .logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            line-height: 0.9;
            margin-bottom: 50px;
            border-left: 10px solid var(--bauhaus-red);
            padding-left: 10px;
        }
        .nav-item {
            padding: 18px 20px;
            margin-bottom: 20px;
            cursor: pointer;
            font-weight: 700;
            text-align: left;
            transition: var(--transition);
            border: none;
        }

        /* ä¸»è¦å…§å®¹å€ */
        main {
            margin-left: 280px;
            padding: 50px;
            width: calc(100% - 280px);
            transition: var(--transition);
        }

        .section { display: none; animation: slideUp 0.6s ease-out; }
        .section.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        /* PDF åŒ¯å…¥å€åŸŸ */
        .card { padding: 30px; margin-bottom: 30px; border-radius: 20px; }
        .import-zone {
            height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 2px dashed var(--nm-shadow);
            margin-bottom: 30px;
            cursor: pointer;
            transition: 0.3s;
        }
        .import-zone:hover { background: rgba(255,255,255,0.3); }

        /* åœ–è¡¨å€ */
        .chart-container { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .svg-box { width: 100%; height: 250px; display: flex; align-items:center; justify-content:center; }

        /* çŸ¥è­˜æ°£æ³¡ */
        .bubble-wall { position: relative; height: 500px; overflow: hidden; }
        .bubble {
            position: absolute; width: 110px; height: 110px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; text-align: center;
            padding: 12px; font-size: 13px; font-weight: bold; cursor: pointer;
            transition: var(--transition); box-shadow: 4px 4px 10px var(--nm-shadow);
        }
        .bubble:hover { transform: scale(1.1) rotate(5deg); z-index: 50; }

        /* ç­†è¨˜èˆ‡æ¼¢å ¡é¸å–® */
        .note-toggle { position: fixed; right: 20px; bottom: 20px; width: 60px; height: 60px; border-radius: 50%; font-size: 24px; cursor: pointer; z-index: 1100; display: flex; align-items: center; justify-content: center; }
        #note-panel { position: fixed; top: 20px; right: -340px; width: 320px; height: calc(100vh - 40px); padding: 25px; transition: var(--transition); z-index: 1050; }
        #note-panel.open { right: 20px; }
        textarea { width: 100%; height: 120px; margin-top: 15px; background: transparent; padding: 10px; border: none; outline: none; }
        
        .hamburger { display: none; position: fixed; top: 20px; left: 20px; font-size: 24px; padding: 10px; z-index: 1200; border: none; cursor: pointer; }

        @media (max-width: 1024px) {
            #sidebar { left: -280px; }
            #sidebar.open { left: 0; }
            main { margin-left: 0; width: 100%; padding-top: 80px; }
            .hamburger { display: block; }
            .chart-container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <button class="hamburger nm-flat" onclick="toggleSidebar()">â˜°</button>

    <nav id="sidebar" class="nm-flat">
        <div class="logo">FINA<br>DASH</div>
        <button class="nav-item nm-flat btn-active" onclick="switchTab('home', this)">PDF è²¡å ±åŒ¯å…¥</button>
        <button class="nav-item nm-flat" onclick="switchTab('analytics', this)">æ™ºæ…§æ¯”ç‡åˆ†æ</button>
        <button class="nav-item nm-flat" onclick="switchTab('knowledge', this)">é—œéµçŸ¥è­˜é»</button>
        <button class="nav-item nm-flat" onclick="switchTab('exam', this)">äº’å‹•æ¼”ç·´</button>
        
        <div style="margin-top: auto; display: grid; gap: 10px;">
            <button class="nm-flat" style="padding: 12px; color: var(--bauhaus-red); font-weight: bold;" onclick="exportReport()">ä¸‹è¼‰å­¸ç¿’æˆæœ</button>
            <button id="gs-btn" class="nm-inset" style="padding: 8px; font-size: 11px;" onclick="uploadToGoogleSheet()">å‚³é€è‡³ Google Sheet</button>
        </div>
    </nav>

    <main>
        <section id="home" class="section active">
            <h1 style="margin-bottom: 10px;">æ™ºæ…§è²¡å ±å°èˆª</h1>
            <p style="opacity: 0.6; margin-bottom: 30px;">ä¸Šå‚³ PDF è²¡å ±ï¼Œç³»çµ±å°‡è‡ªå‹•è§£æé—œéµæ•¸æ“š</p>
            
            <div class="import-zone nm-inset" onclick="document.getElementById('pdf-input').click()">
                <div style="font-size: 50px;">ğŸ“„</div>
                <p style="font-weight: bold; margin-top: 15px;">é»æ“Šæˆ–æ‹–æ”¾ PDF è²¡å ±æª”æ¡ˆ</p>
                <small id="status-text">æ”¯æ´å°ç£ä¸Šå¸‚æ«ƒå…¬å¸å¹´å ±æ ¼å¼</small>
                <input type="file" id="pdf-input" hidden accept=".pdf" onchange="processPDF(this)">
            </div>

            <div id="result-card" class="card nm-flat" style="display: none;">
                <h3 id="res-name" style="color: var(--bauhaus-blue);">è§£ææˆåŠŸ</h3>
                <div id="res-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                    </div>
            </div>
        </section>

        <section id="analytics" class="section">
            <h2 style="margin-bottom: 30px;">è¦–è¦ºåŒ–æŒ‡æ¨™åˆ†æ</h2>
            <div class="chart-container">
                <div class="card nm-flat">
                    <h3>ç›ˆé¤˜å“è³ªæª¢è¦– (Venn Diagram)</h3>
                    <div class="svg-box">
                        <svg width="240" height="180">
                            <circle cx="90" cy="80" r="60" fill="rgba(217, 67, 47, 0.2)" stroke="var(--bauhaus-red)" stroke-width="2"/>
                            <circle cx="150" cy="80" r="60" fill="rgba(45, 90, 158, 0.2)" stroke="var(--bauhaus-blue)" stroke-width="2"/>
                            <text x="50" y="85" font-size="12" font-weight="bold">é«˜ç²åˆ©</text>
                            <text x="145" y="85" font-size="12" font-weight="bold">å¯¦æ”¶ç¾é‡‘</text>
                        </svg>
                    </div>
                    <p style="font-size: 14px; color: var(--text-main);">è§£æï¼šäº¤é›†å€åŸŸè¶Šå¤§ï¼Œä»£è¡¨å…¬å¸è³ºåˆ°çš„éŒ¢ã€ŒçœŸå¯¦é€²è¢‹ã€çš„æ¯”ä¾‹è¶Šé«˜ã€‚</p>
                </div>
                <div class="card nm-flat">
                    <h3>æç›Šå…©å¹³é»æ¨¡å‹</h3>
                    <div class="svg-box">
                        <svg width="100%" height="200" viewBox="0 0 300 150">
                            <line x1="20" y1="130" x2="280" y2="130" stroke="#3d4b5f" stroke-width="2"/>
                            <line x1="20" y1="20" x2="20" y2="130" stroke="#3d4b5f" stroke-width="2"/>
                            <path d="M 20 120 Q 150 70 280 20" fill="none" stroke="var(--bauhaus-red)" stroke-width="3"/>
                            <line x1="20" y1="80" x2="280" y2="80" stroke="var(--bauhaus-blue)" stroke-width="2" stroke-dasharray="5,5"/>
                        </svg>
                    </div>
                    <p style="font-size: 14px; text-align: center;">æ©«è»¸ï¼šç”¢é‡ | ç¸±è»¸ï¼šé‡‘é¡</p>
                </div>
            </div>
        </section>

        <section id="knowledge" class="section">
            <h2 style="margin-bottom: 20px;">æ ¸å¿ƒæœƒè¨ˆçŸ¥è­˜æ°£æ³¡</h2>
            <div id="bubble-container" class="bubble-wall nm-inset"></div>
        </section>

        <section id="exam" class="section">
            <h2 style="margin-bottom: 30px;">äº’å‹•æ¸¬é©—æ¼”ç·´</h2>
            <div id="quiz-card" class="card nm-flat">
                <h3 id="q-text">è«‹å…ˆåŒ¯å…¥è²¡å ±ä»¥é–‹å•Ÿäº’å‹•æŒ‘æˆ°</h3>
                <div id="q-options" style="margin-top: 25px; display: grid; gap: 15px;"></div>
            </div>
        </section>
    </main>

    <div id="note-panel" class="nm-flat">
        <h3 style="border-bottom: 4px solid var(--bauhaus-yellow); display: inline-block;">åˆ†æç­†è¨˜ç°¿</h3>
        <textarea id="note-in" class="nm-inset" placeholder="è§€å¯Ÿåˆ°ä»€éº¼æœ‰è¶£çš„è¶¨å‹¢å—ï¼Ÿ"></textarea>
        <button class="nm-flat" style="padding: 10px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 10px;" onclick="addNote()">å„²å­˜å¿ƒå¾—</button>
        <div id="note-list" style="margin-top: 20px; overflow-y: auto; max-height: 350px;"></div>
    </div>
    <div class="note-toggle nm-flat" onclick="toggleNotes()">ğŸ“</div>

    <script>
        // PDF.js åˆå§‹åŒ–
        const pdfjsLib = window['pdfjs-dist/build/pdf'];
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

        let extractedData = null;
        let notes = JSON.parse(localStorage.getItem('bauhaus_notes')) || [];

        // 20 å€‹é—œéµçŸ¥è­˜é»
        const knowledgePoints = [
            { t: "è³‡ç”¢è² å‚µè¡¨", d: "åæ˜ ä¼æ¥­åœ¨ç‰¹å®šæ™‚é»çš„è²¡å‹™ç‹€æ³ï¼Œæ˜¯ã€Œé«”è³ªæª¢æŸ¥è¡¨ã€ã€‚" },
            { t: "æµå‹•æ¯”ç‡", d: "æµå‹•è³‡ç”¢/æµå‹•è² å‚µã€‚è¡¡é‡ä¸€å¹´å…§å„Ÿå‚µèƒ½åŠ›ï¼Œé€šå¸¸ 200% ä»¥ä¸Šè¼ƒå®‰å…¨ã€‚" },
            { t: "ROE", d: "è‚¡æ±æ¬Šç›Šå ±é…¬ç‡ã€‚è¡¡é‡å…¬å¸ç‚ºè‚¡æ±è³ºéŒ¢çš„æ•ˆç‡ï¼Œæ ¸å¿ƒæŒ‡æ¨™ä¹‹ä¸€ã€‚" },
            { t: "æç›Šè¡¨", d: "å‘ˆç¾ä¸€æ®µæœŸé–“å…§è³ºå¤šå°‘ã€èŠ±å¤šå°‘çš„ã€Œç¶“ç‡Ÿæˆæœè¡¨ã€ã€‚" },
            { t: "ç¾é‡‘æµé‡è¡¨", d: "è¨˜éŒ„çœŸå¯¦ç¾é‡‘é€²å‡ºï¼Œé¿å…å¸³é¢ç²åˆ©å»æ²’ç¾é‡‘çš„å±æ©Ÿã€‚" },
            { t: "æ¯›åˆ©ç‡", d: "(ç‡Ÿæ”¶-æˆæœ¬)/ç‡Ÿæ”¶ã€‚è¶Šé«˜ä»£è¡¨ç”¢å“ç«¶çˆ­åŠ›èˆ‡æº¢åƒ¹èƒ½åŠ›è¶Šå¼·ã€‚" },
            { t: "EPS", d: "æ¯è‚¡ç›ˆé¤˜ã€‚æ¯ä¸€è‚¡è‚¡ç¥¨è³ºåˆ°çš„ç´”åˆ©ã€‚" },
            { t: "å­˜è²¨é€±è½‰ç‡", d: "è¡¡é‡è²¨ç‰©è³£å‡ºçš„é€Ÿåº¦ã€‚é€±è½‰å¤ªæ…¢å¯èƒ½ä»£è¡¨å•†å“æ»¯éŠ·ã€‚" },
            { t: "æ‡‰æ”¶å¸³æ¬¾", d: "å®¢æˆ¶æ¬ å…¬å¸çš„éŒ¢ã€‚éœ€æ³¨æ„å›æ”¶é€Ÿåº¦ï¼Œé¿å…ç”¢ç”Ÿå‘†å¸³ã€‚" },
            { t: "è² å‚µæ¯”ç‡", d: "ç¸½è² å‚µ/ç¸½è³‡ç”¢ã€‚è¡¡é‡è²¡å‹™æ§“æ¡¿ï¼Œéé«˜å¯èƒ½é€ æˆåˆ©æ¯å£“åŠ›ã€‚" },
            { t: "ç‡Ÿæ¥­åˆ©ç›Š", d: "æœ¬æ¥­ç¶“ç‡Ÿè³ºåˆ°çš„éŒ¢ï¼Œä¸åŒ…å«æŠ•è³‡æˆ–è³£åœ°ç­‰æ¥­å¤–æ”¶ç›Šã€‚" },
            { t: "æŠ˜èˆŠ", d: "å°‡è³‡ç”¢æˆæœ¬æ”¤éŠ·åˆ°ä½¿ç”¨å¹´é™ï¼Œæ˜¯éç¾é‡‘æ€§è³ªçš„è²»ç”¨ã€‚" },
            { t: "å•†è­½", d: "ä½µè³¼æ™‚ä»˜å‡ºçš„æº¢åƒ¹ã€‚è‹¥ç¶“ç‡Ÿä¸å–„å¯èƒ½é¢è‡¨ã€Œæ¸›æã€é¢¨éšªã€‚" },
            { t: "è‡ªç”±ç¾é‡‘æµ", d: "ç‡Ÿæ¥­ç¾é‡‘æµæ‰£é™¤è³‡æœ¬æ”¯å‡ºï¼Œæ˜¯å…¬å¸èƒ½è‡ªç”±é‹ç”¨çš„çœŸé‡‘ç™½éŠ€ã€‚" },
            { t: "é€Ÿå‹•æ¯”ç‡", d: "æ‰£é™¤å­˜è²¨å¾Œçš„å„Ÿå‚µèƒ½åŠ›ï¼Œæ¯”æµå‹•æ¯”ç‡æ›´åš´è‹›ã€‚ " },
            { t: "æ¥­å¤–æ”¶ç›Š", d: "éæœ¬æ¥­ç”¢ç”Ÿçš„ç²åˆ©ï¼Œå¦‚åŒ¯å…Œã€è³£è‚¡ç¥¨æˆ–è™•åˆ†è³‡ç”¢ã€‚" },
            { t: "ä¿ç•™ç›ˆé¤˜", d: "ç²åˆ©å¾Œæ²’ç™¼çµ¦è‚¡æ±ï¼Œç•™çµ¦å…¬å¸æœªä¾†ç‡Ÿé‹èˆ‡æŠ•è³‡çš„éŒ¢ã€‚" },
            { t: "è³‡æœ¬æ”¯å‡º", d: "æŠ•è³‡æ–¼å» æˆ¿ã€è¨­å‚™ç­‰é•·æœŸè³‡ç”¢çš„æ”¯å‡ºã€‚" },
            { t: "åˆ©æ¯ä¿éšœå€æ•¸", d: "è³ºä¾†çš„éŒ¢å¤ ä¸å¤ ä»˜åˆ©æ¯ï¼ŸéŠ€è¡Œè©•ä¼°æ”¾æ¬¾çš„é—œéµã€‚" },
            { t: "å¸‚ç›ˆç‡(PE)", d: "è‚¡åƒ¹/EPSã€‚ä»£è¡¨æŠ•è³‡äººé¡˜æ„èŠ±å¹¾å¹´çš„ç²åˆ©åƒ¹æ ¼ä¾†è²·å…¥ã€‚" }
        ];

        // --- PDF è§£ææ ¸å¿ƒé‚è¼¯ ---
        async function processPDF(input) {
            const file = input.files[0];
            if (!file) return;

            document.getElementById('status-text').innerText = "æ­£åœ¨è®€å–ä¸¦æƒæè²¡å ±æ–‡å­—...";
            
            const reader = new FileReader();
            reader.onload = async function() {
                const typedarray = new Uint8Array(this.result);
                const pdf = await pdfjsLib.getDocument(typedarray).promise;
                let fullText = "";
                
                // æƒæå‰ 8 é ä»¥æŠ“å–æ•¸æ“š
                for (let i = 1; i <= Math.min(pdf.numPages, 8); i++) {
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    fullText += textContent.items.map(item => item.str).join(" ");
                }

                // æ¨¡æ“¬è§£æé‚è¼¯ï¼ˆå¯¦éš›å ´æ™¯éœ€é‡å°å°ç£è²¡å ± Regex åŒ¹é…ï¼‰
                // é€™è£¡æ¨¡æ“¬å¾æ–‡å­—ä¸­æŠ“å–æ•¸å€¼
                extractedData = {
                    company: file.name.replace(".pdf", ""),
                    roe: (Math.random() * 10 + 10).toFixed(2),
                    currentRatio: (Math.random() * 100 + 150).toFixed(0),
                    grossMargin: (Math.random() * 20 + 20).toFixed(2)
                };

                updateUI();
            };
            reader.readAsArrayBuffer(file);
        }

        function updateUI() {
            document.getElementById('status-text').innerText = "è§£æå®Œæˆï¼";
            document.getElementById('result-card').style.display = "block";
            document.getElementById('res-name').innerText = `æ•¸æ“šä¾†æºï¼š${extractedData.company}`;
            document.getElementById('res-grid').innerHTML = `
                <div class="nm-inset" style="padding:15px;"><strong>ROE</strong><br><span style="font-size:20px;color:var(--bauhaus-red)">${extractedData.roe}%</span></div>
                <div class="nm-inset" style="padding:15px;"><strong>æµå‹•æ¯”ç‡</strong><br><span style="font-size:20px;color:var(--bauhaus-blue)">${extractedData.currentRatio}%</span></div>
                <div class="nm-inset" style="padding:15px;"><strong>æ¯›åˆ©ç‡</strong><br><span style="font-size:20px;">${extractedData.grossMargin}%</span></div>
                <div class="nm-inset" style="padding:15px;"><strong>ç¾é‡‘æµ</strong><br><span style="color:green">ç©©å®šæ­£å‘</span></div>
            `;
            loadQuiz();
        }

        // --- å°èˆªèˆ‡ä»‹é¢ ---
        function switchTab(id, btn) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('btn-active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('btn-active');
            if(window.innerWidth <= 1024) toggleSidebar();
        }

        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); }
        function toggleNotes() { document.getElementById('note-panel').classList.toggle('open'); }

        // --- çŸ¥è­˜é»æ°£æ³¡ ---
        function initBubbles() {
            const container = document.getElementById('bubble-container');
            const colors = ['var(--bauhaus-red)', 'var(--bauhaus-blue)', 'var(--bauhaus-yellow)'];
            knowledgePoints.forEach((p, i) => {
                const b = document.createElement('div');
                b.className = 'bubble nm-flat';
                b.style.left = Math.random() * 75 + 5 + '%';
                b.style.top = Math.random() * 75 + 5 + '%';
                b.style.background = colors[i % 3] + '15';
                b.style.border = `2px solid ${colors[i % 3]}44`;
                b.innerText = p.t;
                b.onclick = () => alert(`${p.t}\n\n${p.d}`);
                container.appendChild(b);
            });
        }

        // --- ç­†è¨˜ç³»çµ± ---
        function addNote() {
            const text = document.getElementById('note-in').value;
            if(!text) return;
            notes.unshift({ id: Date.now(), text, time: new Date().toLocaleTimeString() });
            localStorage.setItem('bauhaus_notes', JSON.stringify(notes));
            document.getElementById('note-in').value = "";
            renderNotes();
        }

        function renderNotes() {
            document.getElementById('note-list').innerHTML = notes.map(n => `
                <div class="nm-inset" style="padding:10px; margin-bottom:12px; font-size:13px;">
                    <small style="opacity:0.5;">${n.time}</small><br>${n.text}
                </div>
            `).join('');
        }

        // --- äº’å‹•æ¸¬é©— ---
        function loadQuiz() {
            if(!extractedData) return;
            const q = {
                t: `è§€å¯Ÿ ${extractedData.company} çš„æµå‹•æ¯”ç‡ç‚º ${extractedData.currentRatio}%ï¼Œé€™ä»£è¡¨ä»€éº¼ï¼Ÿ`,
                o: ["çŸ­æœŸå„Ÿå‚µé¢¨éšªæ¥µé«˜", "å…¬å¸ç¾é‡‘éå¤šæ²’åœ¨åˆ©ç”¨", "å…·å‚™ç©©å¥çš„çŸ­æœŸé€±è½‰èƒ½åŠ›", "å…¬å¸å³å°‡å€’é–‰"],
                a: 2
            };
            document.getElementById('q-text').innerText = q.t;
            document.getElementById('q-options').innerHTML = q.o.map((opt, i) => `
                <button class="nm-flat" style="padding:15px; text-align:left; cursor:pointer;" onclick="checkAns(${i}, ${q.a})">${opt}</button>
            `).join('');
        }

        function checkAns(i, a) {
            alert(i === a ? "æ­£ç¢ºï¼æµå‹•æ¯”ç‡é«˜æ–¼ 100% ä»£è¡¨æµå‹•è³‡ç”¢è¶³ä»¥è¦†è“‹æµå‹•è² å‚µã€‚" : "ç­”éŒ¯äº†ï¼Œè«‹å†è§€å¯Ÿä¸€æ¬¡æµå‹•æ¯”ç‡çš„æ•¸å€¼ã€‚");
        }

        // --- åŠŸèƒ½ï¼šè¼¸å‡ºèˆ‡ Google Sheet ---
        function exportReport() {
            const blob = new Blob([`è²¡å ±åˆ†æçµæœ\n${JSON.stringify(extractedData)}\n\nç­†è¨˜ï¼š\n${notes.map(n=>n.text).join('\n')}`], {type:'text/plain'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url; a.download = 'è²¡å ±å­¸ç¿’å ±å‘Š.txt'; a.click();
        }

        async function uploadToGoogleSheet() {
            // æ­¤è™•é ç•™çµ¦ä½¿ç”¨è€…å¡«å¯« GAS WebApp ç¶²å€
            const WEB_APP_URL = "YOUR_GOOGLE_APPS_SCRIPT_URL";
            alert("æ­£åœ¨ä¸Šå‚³æ•¸æ“šè‡³ Google Sheet... (è«‹å…ˆåœ¨ç¨‹å¼ç¢¼ä¸­å¡«å…¥ WebApp URL)");
        }

        // åˆå§‹åŒ–
        window.onload = () => {
            initBubbles();
            renderNotes();
        };
    </script>
</body>
</html>